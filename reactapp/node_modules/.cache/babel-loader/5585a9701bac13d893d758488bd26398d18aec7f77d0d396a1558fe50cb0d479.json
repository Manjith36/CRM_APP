{"ast":null,"code":"export const getCurrentUser = () => {\n  const user = localStorage.getItem('user');\n  const parsedUser = user ? JSON.parse(user) : null;\n  console.log('Current user:', parsedUser);\n  return parsedUser;\n};\nexport const isAdmin = () => {\n  const user = getCurrentUser();\n  return user && user.role === 'ADMIN';\n};\nexport const isSalesRep = () => {\n  const user = getCurrentUser();\n  return user && user.role === 'SALES_REP';\n};\nexport const isAnalyst = () => {\n  const user = getCurrentUser();\n  return user && user.role === 'ANALYST';\n};\nexport const logout = () => {\n  localStorage.removeItem('user');\n};\nexport const hasPermission = action => {\n  const user = getCurrentUser();\n  if (!user) {\n    console.log('No user found for permission check:', action);\n    return false;\n  }\n  console.log(`Checking permission '${action}' for user role '${user.role}'`);\n  switch (action) {\n    case 'VIEW_CUSTOMERS':\n      return true;\n    // All roles can view customers\n    case 'CREATE_CUSTOMER':\n      return user.role === 'ADMIN' || user.role === 'SALES_REP';\n    case 'UPDATE_CUSTOMER':\n      return user.role === 'ADMIN' || user.role === 'SALES_REP';\n    case 'DELETE_CUSTOMER':\n      return user.role === 'ADMIN';\n    // Only ADMIN can delete\n    case 'VIEW_INTERACTIONS':\n      return true;\n    // All roles can view interactions\n    case 'CREATE_INTERACTION':\n      return user.role === 'ADMIN' || user.role === 'SALES_REP';\n    case 'UPDATE_INTERACTION':\n      return user.role === 'ADMIN' || user.role === 'SALES_REP';\n    case 'DELETE_INTERACTION':\n      return user.role === 'ADMIN';\n    case 'VIEW_CHARTS':\n      return user.role === 'ADMIN' || user.role === 'ANALYST';\n    // SALES_REP cannot view analytics\n    case 'MANAGE_USERS':\n      return false;\n    // No role can manage users\n    default:\n      return false;\n  }\n};","map":{"version":3,"names":["getCurrentUser","user","localStorage","getItem","parsedUser","JSON","parse","console","log","isAdmin","role","isSalesRep","isAnalyst","logout","removeItem","hasPermission","action"],"sources":["C:/Manjith/IndustrialClass/appdev/CRM git clone/108b8873-2654-4e35-b3ed-6a7e85a9f5ba-c9294f9a-6796-45dd-afc7-5c6ed2890fb3/reactapp/src/utils/auth.js"],"sourcesContent":["export const getCurrentUser = () => {\n  const user = localStorage.getItem('user');\n  const parsedUser = user ? JSON.parse(user) : null;\n  console.log('Current user:', parsedUser);\n  return parsedUser;\n};\n\nexport const isAdmin = () => {\n  const user = getCurrentUser();\n  return user && user.role === 'ADMIN';\n};\n\nexport const isSalesRep = () => {\n  const user = getCurrentUser();\n  return user && user.role === 'SALES_REP';\n};\n\nexport const isAnalyst = () => {\n  const user = getCurrentUser();\n  return user && user.role === 'ANALYST';\n};\n\nexport const logout = () => {\n  localStorage.removeItem('user');\n};\n\nexport const hasPermission = (action) => {\n  const user = getCurrentUser();\n  if (!user) {\n    console.log('No user found for permission check:', action);\n    return false;\n  }\n  \n  console.log(`Checking permission '${action}' for user role '${user.role}'`);\n  \n  switch (action) {\n    case 'VIEW_CUSTOMERS':\n      return true; // All roles can view customers\n    case 'CREATE_CUSTOMER':\n      return user.role === 'ADMIN' || user.role === 'SALES_REP';\n    case 'UPDATE_CUSTOMER':\n      return user.role === 'ADMIN' || user.role === 'SALES_REP';\n    case 'DELETE_CUSTOMER':\n      return user.role === 'ADMIN'; // Only ADMIN can delete\n    case 'VIEW_INTERACTIONS':\n      return true; // All roles can view interactions\n    case 'CREATE_INTERACTION':\n      return user.role === 'ADMIN' || user.role === 'SALES_REP';\n    case 'UPDATE_INTERACTION':\n      return user.role === 'ADMIN' || user.role === 'SALES_REP';\n    case 'DELETE_INTERACTION':\n      return user.role === 'ADMIN';\n    case 'VIEW_CHARTS':\n      return user.role === 'ADMIN' || user.role === 'ANALYST'; // SALES_REP cannot view analytics\n    case 'MANAGE_USERS':\n      return false; // No role can manage users\n    default:\n      return false;\n  }\n};"],"mappings":"AAAA,OAAO,MAAMA,cAAc,GAAGA,CAAA,KAAM;EAClC,MAAMC,IAAI,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;EACzC,MAAMC,UAAU,GAAGH,IAAI,GAAGI,IAAI,CAACC,KAAK,CAACL,IAAI,CAAC,GAAG,IAAI;EACjDM,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEJ,UAAU,CAAC;EACxC,OAAOA,UAAU;AACnB,CAAC;AAED,OAAO,MAAMK,OAAO,GAAGA,CAAA,KAAM;EAC3B,MAAMR,IAAI,GAAGD,cAAc,CAAC,CAAC;EAC7B,OAAOC,IAAI,IAAIA,IAAI,CAACS,IAAI,KAAK,OAAO;AACtC,CAAC;AAED,OAAO,MAAMC,UAAU,GAAGA,CAAA,KAAM;EAC9B,MAAMV,IAAI,GAAGD,cAAc,CAAC,CAAC;EAC7B,OAAOC,IAAI,IAAIA,IAAI,CAACS,IAAI,KAAK,WAAW;AAC1C,CAAC;AAED,OAAO,MAAME,SAAS,GAAGA,CAAA,KAAM;EAC7B,MAAMX,IAAI,GAAGD,cAAc,CAAC,CAAC;EAC7B,OAAOC,IAAI,IAAIA,IAAI,CAACS,IAAI,KAAK,SAAS;AACxC,CAAC;AAED,OAAO,MAAMG,MAAM,GAAGA,CAAA,KAAM;EAC1BX,YAAY,CAACY,UAAU,CAAC,MAAM,CAAC;AACjC,CAAC;AAED,OAAO,MAAMC,aAAa,GAAIC,MAAM,IAAK;EACvC,MAAMf,IAAI,GAAGD,cAAc,CAAC,CAAC;EAC7B,IAAI,CAACC,IAAI,EAAE;IACTM,OAAO,CAACC,GAAG,CAAC,qCAAqC,EAAEQ,MAAM,CAAC;IAC1D,OAAO,KAAK;EACd;EAEAT,OAAO,CAACC,GAAG,CAAC,wBAAwBQ,MAAM,oBAAoBf,IAAI,CAACS,IAAI,GAAG,CAAC;EAE3E,QAAQM,MAAM;IACZ,KAAK,gBAAgB;MACnB,OAAO,IAAI;IAAE;IACf,KAAK,iBAAiB;MACpB,OAAOf,IAAI,CAACS,IAAI,KAAK,OAAO,IAAIT,IAAI,CAACS,IAAI,KAAK,WAAW;IAC3D,KAAK,iBAAiB;MACpB,OAAOT,IAAI,CAACS,IAAI,KAAK,OAAO,IAAIT,IAAI,CAACS,IAAI,KAAK,WAAW;IAC3D,KAAK,iBAAiB;MACpB,OAAOT,IAAI,CAACS,IAAI,KAAK,OAAO;IAAE;IAChC,KAAK,mBAAmB;MACtB,OAAO,IAAI;IAAE;IACf,KAAK,oBAAoB;MACvB,OAAOT,IAAI,CAACS,IAAI,KAAK,OAAO,IAAIT,IAAI,CAACS,IAAI,KAAK,WAAW;IAC3D,KAAK,oBAAoB;MACvB,OAAOT,IAAI,CAACS,IAAI,KAAK,OAAO,IAAIT,IAAI,CAACS,IAAI,KAAK,WAAW;IAC3D,KAAK,oBAAoB;MACvB,OAAOT,IAAI,CAACS,IAAI,KAAK,OAAO;IAC9B,KAAK,aAAa;MAChB,OAAOT,IAAI,CAACS,IAAI,KAAK,OAAO,IAAIT,IAAI,CAACS,IAAI,KAAK,SAAS;IAAE;IAC3D,KAAK,cAAc;MACjB,OAAO,KAAK;IAAE;IAChB;MACE,OAAO,KAAK;EAChB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}